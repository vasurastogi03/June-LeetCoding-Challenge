It can be done with binary search and upper bound
